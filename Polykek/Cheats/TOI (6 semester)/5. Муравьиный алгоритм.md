#Polykek/cheats/TOI #искусственный-интеллект 

В этой лекции рассматривается интересный алгоритм, основанный на применении нескольких агентов, с помощью которого можно решать самые разнообразные задачи. Алгоритмы муравья (Ant algorithms), или оптимизация по принципу муравьиной колонии (это название было придумано изобретателем алгоритма, Марко Дориго (Marco Dorigo)), обладают специфическими свойствами, присущими муравьям, и используют их для ориентации в физическом пространстве. Алгоритмы муравья особенно интересны потому, что их можно использовать для решения не только статичных, но и динамических проблем, например, проблем маршрутизации в меняющихся сетях

## Естественная мотивация

Хотя муравьи и слепы, они умеют перемещаться по сложной местности, находить пищу на большом расстоянии от муравейника и успешно возвращаться домой. Выделяя ферменты во время перемещения, муравьи изменяют окружающую среду, обеспечивают коммуникацию, а также отыскивают обратный путь в муравейник.

Самое удивительное в данном процессе – это то, что муравьи умеют находить самый оптимальный путь между муравейником и внешними точками. Чем больше муравьев используют один и тот же путь, тем выше концентрация ферментов на этом пути. Чем ближе внешняя точка к муравейнику, тем больше раз к ней перемещались муравьи. Что касается более 2 удаленной точки, то ее муравьи достигают реже, поэтому по дороге к ней они применяют более сильные ферменты. Чем выше концентрация ферментов на пути, тем предпочтительнее он для муравьев по сравнению с другими доступными. Так муравьиная «логика» позволяет выбирать более короткий путь между конечными точками.

Алгоритмы муравья интересны, поскольку отражают ряд специфических свойств, присущих самим муравьям. Муравьи легко вступают в сотрудничество и работают вместе для достижения общей цели. Алгоритмы муравья работают так же, как муравьи. Это выражается в том, что смоделированные муравьи совместно решают проблему и помогают другим муравьям в дальнейшей оптимизации решения.

Рассмотрим пример, представленный на рис. 1. Два муравья из муравейника должны добраться до пищи, которая находится за препятствием. Во время перемещения каждый муравей выделяет немного фермента, используя его в качестве маркера.

![[Pasted image 20240611071100.png]]

При прочих равных каждый муравей выберет свой путь. Первый муравей выбирает верхний путь, а второй – нижний. Так как нижний путь в два раза короче верхнего, второй муравей достигнет цели за время T1. Первый муравей в этот момент пройдет только половину пути (рис. 2).

![[Pasted image 20240611071117.png]]

Когда один муравей достигает пищи, он берет один из объектов и возвращается к муравейнику по тому же пути. За время T2 второй муравей вернулся в муравейник с пищей, а первый муравей достиг пищи (рис. 3).

![[Pasted image 20240611071130.png]]

Вспомните, что при перемещении каждого муравья на пути остается немного фермента. Для первого муравья за время T0–T2 путь был покрыт ферментом только один раз. В то же самое время второй муравей покрыл путь ферментом дважды. За время T4 первый муравей вернулся в муравейник, а второй муравей уже успел еще раз сходить к еде и вернуться. При этом концентрация фермента на нижнем пути будет в два раза выше, чем на верхнем. Поэтому первый муравей в следующий раз выберет нижний путь, поскольку там концентрация фермента выше.

В этом и состоит базовая идея алгоритма муравья – оптимизация путем непрямой связи между автономными агентами.

## Алгоритм муравья

Подробно рассмотрим алгоритм муравья, чтобы понять, как он работает при решении конкретной проблемы.

### Граф

Предположим, что окружающая среда для муравьев представляет собой закрытую двумерную сеть. Вспомните, что сеть – это группа узлов, соединенных посредством граней. Каждая грань имеет вес, который мы обозначим как расстояние между двумя узлами, соединенными ею. Граф двунаправленный, поэтому муравей может путешествовать по грани в любом направлении (рис. 4).

![[Pasted image 20240611071206.png]]

### Муравей

Муравей – это программный агент, который является членом большой колонии и используется для решения какой-либо проблемы. Муравей снабжается набором простых правил, которые позволяют ему выбирать путь в графе. Он поддерживает список табу (tabu list), то есть список узлов, которые он уже посетил. Таким образом, муравей должен проходить через каждый узел только один раз. Путь между двумя узлами графа, по которому муравей 6 посетил каждый узел только один раз, называется путем Гамильтона (Hamiltonian path), по имени математика сэра Уильяма Гамильтона (Sir William Hamilton).

Узлы в списке «текущего путешествия» располагаются в том порядке, в котором муравей посещал их. Позже список используется для определения протяженности пути между узлами.

Настоящий муравей во время перемещения по пути будет оставлять за собой фермент. В алгоритме муравья агент оставляет фермент на гранях сети после завершения путешествия. О том, как это происходит, рассказывается в разделе «Путешествие муравья»

### Начальная популяция

После создания популяция муравьев поровну распределяется по узлам сети. Необходимо равное разделение муравьев между узлами, чтобы все узлы имели одинаковые шансы стать отправной точкой. Если все муравьи начнут движение из одной точки, это будет означать, что данная точка является оптимальной для старта, а на самом деле мы этого не знаем.

Движение муравья основывается на одном и очень простом вероятностном уравнении. Если муравей еще не закончил путь (path), то есть не посетил все узлы сети, для определения следующей грани пути используется уравнение:

![[Pasted image 20240611071254.png]]

Здесь τ(r,u) – интенсивность фермента на грани между узлами r и u, τ(r,u) – функция, которая представляет измерение обратного расстояния для грани, α – вес фермента, а β – коэффициент эвристики. Параметры α и β определяют относительную значимость двух параметров, а также их влияние на уравнение. Вспомните, что муравей путешествует только по узлам, которые еще не были посещены (как указано списком табу). Поэтому вероятность рассчитывается 7 только для граней, которые ведут к еще не посещенным узлам. Переменная k представляет грани, которые еще не были посещены.

### Путешествие муравья 

Пройденный муравьем путь отображается, когда муравей посетит все узлы диаграммы. Обратите внимание, что циклы запрещены, поскольку в алгоритм включен список табу. После завершения длина пути может быть подсчитана – она равна сумме всех граней, по которым путешествовал муравей. Уравнение 2 ниже показывает количество фермента, который был оставлен на каждой грани пути для муравья k. Переменная Q является константой.

![[Pasted image 20240611071315.png]]

Результат уравнения является средством измерения пути, – короткий путь характеризуется высокой концентрацией фермента, а более длинный путь – более низкой. Затем полученный результат используется в уравнении 3, чтобы увеличить количество фермента вдоль каждой грани пройденного муравьем пути

![[Pasted image 20240611071327.png]]

Обратите внимание, что данное уравнение применяется ко всему пути, при этом каждая грань помечается ферментом пропорционально длине пути. Поэтому следует дождаться, пока муравей закончит путешествие и только потом обновить уровни фермента, в противном случае истинная длина пути останется неизвестной. Константа ρ – значение между 0 и 1.

### Испарение фермента

В начале пути у каждой грани есть шанс быть выбранной. Чтобы постепенно удалить грани, которые входят в худшие пути в сети, ко всем граням применяется процедура испарения фермента (Pheromone evaporation). Используя константу ρ из уравнения 3, мы получаем уравнение 4.

![[Pasted image 20240611071353.png]]

Поэтому для испарения фермента используется обратный коэффициент обновления пути

### Повторный запуск

После того как путь муравья завершен, грани обновлены в соответствии с длиной пути и произошло испарение фермента на всех гранях, алгоритм запускается повторно. Список табу очищается, и длина пути обнуляется. Муравьям разрешается перемещаться по сети, основывая выбор грани на уравнении 1

Этот процесс может выполняться для постоянного количества путей или до момента, когда на протяжении нескольких запусков не было отмечено повторных изменений. Затем определяется лучший путь, который и является решением.

### Пример итерации

Давайте разберем функционирование алгоритма на простом примере, чтобы увидеть, как работают уравнения. Вспомните (рис. 1) простой сценарий с двумя муравьями, которые выбирают два разных пути для достижения одной цели. На рис. 5 показан этот пример с двумя гранями между двумя узлами (V0 и V1). Каждая грань инициализируется и имеет одинаковые шансы на то, чтобы быть выбранной.

![[Pasted image 20240611071600.png]]

Два муравья находятся в узле V0 и помечаются как A0 и A1. Так как вероятность выбора любого пути одинакова, в этом цикле мы проигнорируем уравнение выбора пути. На рис. 6 каждый муравей выбирает свой путь (муравей A0 идет по верхнему пути, а муравей A1 – по нижнему)

В таблице на рис. 6 показано, что муравей A0 сделал 20 шагов, а муравей A1 – только 10. По уравнению 2 мы рассчитываем количество фермента, которое должно быть «нанесено».

Далее по уравнению 3 рассчитывается количество фермента, которое будет применено. Для муравья A0 результат составляет: = 0,1 + (0,5 × 0,6) = 0,4.

![[Pasted image 20240611071623.png]]

Для муравья A1 результат составляет: 
= 0,1 + (1,0 × 0,6) = 0,7. 
Далее с помощью уравнения 4 определяется, какая часть фермента испарится и, соответственно, сколько останется. 
Результаты (для каждого пути) составляют: 
= 0,4 × (1,0 – 0,6) = 0,16 
= 0,7 × (1,0 – 0,6) = 0,28.

Эти значения представляют новое количество фермента для каждого пути (верхнего и нижнего, соответственно). Теперь переместим муравьев обратно в узел V0 и воспользуемся вероятностным уравнением 1 выбора пути, чтобы определить, какой путь должны выбрать муравьи.

Вероятность того, что муравей выберет верхний путь (представленный количеством фермента 0,16), составляет:

(0,16)3,0 × (0,5)1,0 / ((0,16)3,0 × (0,5)1,0) + ((0,28)3,0 × (1,0)1,0) = 0,002048 / 0,024 = P(0,085).

Вероятность того, что муравей выберет нижний путь (представленный количеством фермента 0,28), составляет:

(0,28)3,0 × (1,0)1,0 / ((0,16)3,0 × (0,5)1,0) + ((0,28)3,0 × (1,0)1,0) = 0,021952 / 0,024 = P(0,915).

При сопоставлении двух вероятностей оба муравья выберут нижний путь, который является наиболее оптимальным.

### Изменение параметров алгоритма

Марко Дориго (изобретатель оптимизации по принципу муравьиной колонии) предлагает очень интересную дискуссию по параметрам алгоритма в статье «Система муравьев: оптимизация с помощью колонии сотрудничающих агентов» (The Ant System: Optimization by a Colony of Cooperating Agents).

В этом разделе рассказывается о его предложениях по изменениям параметров алгоритма.

### Alpha (α) / Beta (β)
Был открыт ряд комбинаций α/β, которые позволяют находить хорошие решения за небольшое время. Эти комбинации приведены в табл. 1.

![[Pasted image 20240611071810.png]]

Параметр α ассоциируется с количеством фермента (из уравнения 1), а параметр β – с видимостью (длинной грани). Чем больше значение параметра, тем он важнее для вероятностного уравнения, которое используется при выборе грани. Обратите внимание, что в одном случае значимость параметров равна. Во всех других случаях видимость более важна при выборе пути.

### Rho (ρ)
Параметр ρ представляет коэффициент, который применяется к распыляемому на пути ферменту, а (1,0 – ρ) представляет коэффициент испарения для существующего фермента. Были проведены тесты при ρ > 0,5, и все они показали интересные результаты. При установке значения ρ < 0,5 результаты были неудовлетворительными.

В первую очередь этот параметр определяет концентрацию фермента, которая сохранится на гранях.

### Количество муравьев

Количество муравьев повлияло на качество полученных решений. Хотя увеличение количества муравьев может показаться хорошей идеей, наилучший результат достигается в том случае, если количество муравьев равно количеству городов.

### Другие области применения

Алгоритм муравья может применяться для решения многих задач, таких как распределение ресурсов и работы.

При решении задачи распределения ресурсов (Quadratic Asigment Problem – QAP) необходимо задать группу ресурсов n для ряда адресатов m и при этом минимизировать расходы на перераспределение (то есть функция должна найти наилучший способ распределения ресурсов). Обнаружено, что алгоритм муравья дает решения такого же качества, как и другие, более стандартные способы.

Намного сложнее проблема распределения работы (Jobshop Sheduling Problem – JSP). В этой задаче группа машин M и заданий J (состоящих из последовательности действий, осуществляемых на машинах) должны быть распределены таким образом, чтобы все задания выполнялись за минимальное время. Хотя решения, найденные с помощью алгоритма муравья, не являются оптимальными, применение алгоритма для данной проблемы показывает, что с его помощью можно решать аналогичные задачи.

Алгоритм муравья применяется для решения других задач, например, прокладки маршрутов для автомобилей, расчета цветов для графиков и маршрутизации в сетях. Более подробно способы использования алгоритма муравья описываются в книге Марко Дориго «Алгоритмы муравья для абстрактной оптимизации» (Ant Algorithms for Discrete Optimization).

## Муравьиный алгоритм. Пример.

![[Pasted image 20240611071929.png]]

Где: Pij это удельная вероятность, того что муравей пойдет по пути из i в j. 
𝜂𝑖𝑗 = $1 / 𝐿𝑖𝑗$  
`η` – этта, параметр обратный расстоянию k – допустимые пункты перехода из пункта i 
`α и β` – коэффициенты задающие значимости расстояния и популярности перехода.

Возьмем `α = 1, β =1`:

![[Pasted image 20240611072112.png]]

Элитный муравей идет туда, где P больше (элитных муравьев добавляют для ускорения решения).

Обычный муравей выбирает путь в соответствии с методом МонтеКарло.

![[Pasted image 20240611072128.png]]

Допустим мы выбрали вершину 4:

![[Pasted image 20240611072138.png]]

![[Pasted image 20240611072148.png]]

Количество феромона, оставленное муравьем вычисляем по формуле: 
`∆𝜏 = 𝑄 𝐿0` 

Чем меньше 𝐿0, тем больше феромонов добавится. 
`Q` – величина, подбираемая для получения `∆𝜏` соизмеримой с `τ` Новое значение `τ` рассчитывается как: 
`𝜏𝑘𝑗 ∗ = 𝜏𝑘𝑗 + ∆𝜏` 

Для учета высыхания феромона вводят коэффициент высыхания P<1. 
`𝜏𝑘𝑗 ∗ = 𝜏𝑘𝑗 ∗ (1 − 𝑃) + ∆𝜏` 

Чем больше P, тем больше высыхание. При P=1 опыт старых поколений учитываться не будет, и наоборот при P=0 будет учитываться в полной мере все действия предыдущих поколений. Но последний случай плох тем, что он снижает, для новых поколений, шанс найти лучший путь!!!

## Итоги

В этой лекции описывался метод оптимизации поиска путей, позаимствованный у природы. Алгоритм муравья моделирует поведение муравьев в их природной среде, чтобы определить оптимальный путь в пространстве (по графу или сети). Кроме того, были описаны возможности изменения параметров алгоритма и представлены комбинации параметров, которые демонстрируют хорошие результаты.