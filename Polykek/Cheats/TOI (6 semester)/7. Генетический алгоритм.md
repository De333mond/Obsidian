#Polykek/cheats/TOI #искусственный-интеллект 

В этой лекции моделирование эволюции рассматривается как средство решения компьютерных проблем. Генетический алгоритм, разработанный Джоном Холландом (John Holland), является поисковой программой, которая работает с группой закодированных решений заданной проблемы. Чтобы проиллюстрировать выполнение алгоритма, мы воспользуемся расчетом по эволюционной модели для выведения последовательности действий, которые представляют собой простой алгоритм. Джон Коза (John Koza) назвал этот процесс генетическим программированием.

## Биологическое побуждение

Генетический алгоритм (Genetic algorithm) представляет собой технику оптимизации, которая моделирует феномен естественной эволюции (впервые открытый Чарльзом Дарвином). При естественной эволюции выживают и дают самое многочисленное потомство особи, наиболее адаптированные к сложным условиям окружающей среды. Степень адаптации, в свою очередь, зависит от набора хромосом конкретной особи, полученным от родителей. Это основа выживания сильнейшего – не только процесс выживания, но и участие в формировании следующего поколения. В природе выживание является определяющей и основной функцией.

## Генетический алгоритм

Генетический алгоритм не пытается оптимизировать единственное решение. Он работает с группой решений, которые кодируются, подобно 2 хромосомам. Отдельные гены хромосомы представляют собой уникальные переменные для изучаемой проблемы (рис. 1).

Как видно на простом примере (рис. 1), за основу берутся параметры проблемы и создается хромосома, которая представляет собой два уникальных независимых параметра. Параметры могут быть группой битов, переменными с плавающей точкой или простыми двузначны ми числами в двоичном коде.

![[Pasted image 20240611073608.png]]

При отборе «здоровых» хромосом из популяции и использовании генетических операторов (таких как рекомбинирование и мутация) в популяции остаются только те хромосомы, которые лучше всех приспособлены к окружающей среде, то есть наиболее полно отвечают задаче. Именно так работает теорема Холланда.

Выполнение генетического алгоритма включает три основных шага (причем для каждого шага предусмотрен большой разброс возможных вариантов). Эти шаги показаны на рис. 2.

![[Pasted image 20240611073627.png]]

Генетический алгоритм выполняется в три этапа (если не учитывать начальное создание популяции). Во время оценки определяется здоровье популяции. Далее производится отбор подгруппы хромосом на основании предварительно заданного критерия. Наконец, выбранная подгруппа рекомбинируется, в результате чего получается новая популяция. Алгоритм выполняется заново с новой популяцией. Процесс продолжается до тех пор, пока не будет достигнут определенный предел. Тогда работа алгоритма считается завершенной.

## Инициализация

Создание начальной популяции (Initialization) позволяет сформировать отправную точку для работы алгоритма. Обычно это выполняется путем произвольного создания хромосом, но также допускается добавлять в популяцию «здоровые» хромосомы (рис. 3)
![[Pasted image 20240611073646.png]]

## Оценка

Этап оценки (Evaluation) дает возможность определить, как каждая хромосома (решение) справляется с данной проблемой. Алгоритм декодирует хромосому применительно к проблеме и проверяет результат решения проблемы с использованием новых параметров. Затем на основании результата рассчитывается «здоровье» хромосомы (рис. 4).

![[Pasted image 20240611073703.png]]

## Отбор

Отбор (Selection) является, вероятно, наиболее важным и самым трудным для понимания этапом генетического алгоритма. На этом этапе хромосомы выбираются для дальнейшего использования в другой популяции.

Отбор осуществляется на основании здоровья хромосом (то есть того, насколько эффективно они решают данную проблему). Этот процесс является двусторонним, так как если включить в выбор только очень здоровые хромосомы, то решение становится слишком ограниченным по причине недостаточного разнообразия. Если выбор осуществляется произвольно, то нет гарантии, что здоровье последующих поколений будет улучшаться. В результате выбирается группа хромосом, которые будут участвовать в рекомбинировании (или скрещивании). Процесс выбора представлен на рис. 5.

Существует множество алгоритмов отбора. На рис. 5 показан алгоритм, известный как «Отбор по методу рулетки», или вероятностный отбор. При использовании этого метода отбор из популяции основывается на здоровье хромосомы. Чем лучше здоровье хромосомы, тем больше вероятность того, что она будет выбрана (или повторно выбрана) для формирования следующего поколения. Таким образом, вероятность выбора пропорциональна здоровью хромосомы. На рис. 5 хромосома 2 была выбрана для дальнейшего использования два раза, хромосома 3 – тоже два раза, а хромосома 5 – только один раз. Хромосомы 1 и 4 не были выбраны ни разу, поэтому они исчезают из последующей популяции.

![[Pasted image 20240611073731.png]]

## Рекомбинирование

При рекомбинировании (Recombination) части хромосом перемещаются, может быть, даже изменяются, а получившиеся новые хромосомы возвращаются обратно в популяцию для формирования следующего поколения. Первая группа хромосом обычно называется родителями, а вторая – детьми. С одинаковой вероятностью могут применяться один или несколько генетических операторов. Доступные операторы включают мутацию и перекрестное скрещивание, которые являются аналогами одноименных генетических процессов. В следующем разделе рассматриваются примеры генетических операторов. Процесс рекомбинирования представлен на рис. 6.

В результате рекомбинирования образуется новая популяция хромосом. Процесс повторяется заново с этапа оценки до тех пор, пока проблема не будет решена или пока не будет выполнено любое другое условие завершения алгоритма (например, максимально возможное количество поколений).

![[Pasted image 20240611073805.png]]

## Генетические операторы

Существует огромное количество генетических операторов (Genetic operator), однако только несколько используется при решении общих задач. Перекрестное скрещивание и мутация, о которых рассказывается ниже, являются прямыми аналогами естественных процессов.

## Перекрестное скрещивание

Оператор перекрестного скрещивания (Crossover) берет две хромосомы, разделяет их в произвольной точке (для каждой хромосомы), а затем меняет 7 местами получившиеся «хвосты». При этом образуются две новые хромосомы. Разделение хромосомы в одной точке (получившее название перекрестного скрещивания в одной точке) является не единственной возможностью (рис. 7а). Также можно использовать разделение в нескольких точках (рис. 7б).

При перекрестном скрещивании в популяции не создается новый материал, выполняется просто ее изменение с целью создания новых хромосом. Это позволяет генетическому алгоритму выполнять поиск решения проблемы среди существующих решений. Оператор перекрестного скрещивания является самым важным и используется чаще всего. Второй оператор, мутация, предлагает возможность создания нового материала в популяции.

![[Pasted image 20240611073832.png]]

![[Pasted image 20240611073839.png]]

## Мутация

Оператор мутации (Mutation) вносит произвольное изменение в гены хромосомы (иногда даже несколько изменений в зависимости от частоты применения). Он позволяет создавать в популяции новый материал. Так как новые хромосомы просто перемешиваются с уже существующими, мутация предлагает возможность «перетряхнуть» популяцию и расширить область поиска решения (рис. 8).

![[Pasted image 20240611073857.png]]

## Пример выполнения генетического алгоритма

До сих пор наше обсуждение было теоретическим. Теперь рассмотрим итерацию алгоритма, чтобы понять принцип его работы. В этом примере выполняется поиск параметров, которые позволяют максимизировать уравнение 1:
![[Pasted image 20240611073917.png]]

Это уравнение графически представлено на рис..9 (трехмерный график) и рис. 10 (контурный график).

![[Pasted image 20240611073927.png]]

Хромосомы в этом примере были построены из двух генов (или параметров), x и y. Сначала необходимо создать фонд хромосом, к которым будет применяться генетический алгоритм. В табл. 1 показана начальная популяция, которая была выбрана произвольно.

![[Pasted image 20240611073945.png]]

Теперь, когда сформирована начальная популяция, можно приступать к оценке. Чтобы оценить хромосомы в популяции, следует определить здоровье каждой хромосомы. В этом случае здоровье равно значению уравнения 1 для соответствующих значений параметров. Чем больше значение уравнения, тем лучше здоровье хромосомы. В табл. 2 показаны значения здоровья для оцениваемых хромосом.

![[Pasted image 20240611074006.png]]

Хромосома C1 очень маленькая, и поэтому вероятность ее выбора невелика. Необходимо выбрать две пары родителей для рекомбинирования. Каждый родитель при перекрестном скрещивании будет влиять на детей в следующем поколении. На основании показателей здоровья алгоритм выбирает хромосомы C3 и C2 в качестве первой пары родителей, а хромосомы 11 C3 и C0 – в качестве второй пары. Поскольку в хромосоме только два гена, нужно осуществить разделение на генном уровне, что приводит к разделению элементов x и y хромосомы. В табл. 3 показана новая популяция (источники генов заключены в круглые скобки), а также здоровье каждой новой хромосомы.

![[Pasted image 20240611074024.png]]

Теперь сравним значения здоровья, представленные в табл. 2, со значениями здоровья новой популяции в табл. 3. Очевидно, что данные значения увеличились (наибольшее значение в t0 было равно 0,44, а наибольшее значение в t1 составляет 0,8). Это значит, что лучшее решение в новой популяции эффективнее, чем лучшее решение в предыдущей популяции. Среднее здоровье в первой популяции равно 0,231, а среднее здоровье в новой популяции составляет 0,39, что демонстрирует явное улучшение в популяции при использовании генетического алгоритма.

В этом примере не применялся оператор мутации. Для решения подобной проблемы можно использовать мутацию, как небольшие произвольные изменения значений генов (например, прибавление или вычитание небольшого значения, скажем, 0,1).

### Примечание

Этот пример показывает, что с помощью оператора перекрестного скрещивания нельзя добиться идеального решения, поскольку для поиска решения он использует уже имеющийся генетический материал популяции. Существует ограниченное число комбинаций, поэтому для расширения области поиска следует использовать мутацию, которая позволяет внести в популяцию новый материал.

### Настройка параметров и процессов

Можно не только изменять множество параметров генетического алгоритма (например, метод отбора или рекомбинирования), но и управлять коэффициентами применения генетических операторов. Получается, что не существует оптимального набора методов и параметров, который сумел бы решить любую задачу. Каждая задача должна рассматриваться отдельно, чтобы решить ее быстрее или более эффективным способом (а в некоторых случаях хотя бы решить). В этом разделе описываются способы настройки параметров генетического алгоритма для решения определенной задачи.

### Метод отбора
Ранее рассматривался метод вероятностного выбора: чем выше здоровье хромосомы, тем больше вероятность, что она будет выбрана для формирования последующего поколения. Однако трудность вероятностного выбора состоит в том, что может отсеиваться даже здоровая хромосома. Чтобы гарантировать рекомбинирование самых здоровых хромосом, можно использовать метод элиты, который заключается в автоматическом переносе некоторого количества (например, 10%) самых здоровых хромосом в следующее поколение.

Существует еще один интересный механизм выбора, который называется методом турнира. Из популяции выбираются две или несколько хромосом, которые затем соревнуются за право попасть в следующее поколение. Побеждает та хромосома, здоровье которой выше. Турнир повторяется два раза, и в результате выбираются два родителя, которые переходят в следующее поколение.

## Размер популяции
Размер популяции является весьма важным элементом генетического алгоритма. Если популяция слишком мала, генетического материала может не хватить для решения данной проблемы. Размер популяции также влияет на коэффициент применения операторов мутации и перекрестного скрещивания.

## Генетические операторы
В предыдущих разделах были рассмотрены операторы мутации и перекрестного скрещивания. Существуют и другие операторы, с помощью которых можно решить данную проблему. Достаточно успешно показал себя оператор инверсии (inversion), который переставляет группу генов в хромосоме

## Другие механизмы

Создание популяции является интересной методикой, которая позволяет генетическому алгоритму найти подход к решению проблемы. Вместо того чтобы инициализировать популяцию со случайным набором хромосом, разработчик добавляет хромосомы, которые изначально представляют хорошие решения проблемы. Это может привести к быстрому схождению популяции (то есть потере разнообразия в генетическом фонде), поэтому при использовании подобной методики следует соблюдать повышенную осторожность.

Не менее интересно экспериментировать со схемами скрещивания, которые берут свое начало в садоводстве и разведении домашних животных. Р. Хольштейн (R. Hollstein) исследовал множество методов селекции (табл. 5).

| Метод                    | Описание                                                                         |
| ------------------------ | -------------------------------------------------------------------------------- |
| Тестирование потомства   | От здоровья потомства зависит последующее скрещивание родителей                  |
| Индивидуальная селекция  | Здоровье индивидуума определяет его последующий выбор как родителя               |
| Выбор семьи              | От здоровья семьи зависит использование ее членов в качестве родителей           |
| Выбор в семье            | Здоровье индивидуумов в семье определяет выбор родителей для скрещивания в семье |
| Комбинированная селекция | Комбинируются несколько вышеописанных методов                                    |

Последняя опция – это самостоятельная адаптация генетических операторов и/или коэффициентов их применения. Томас Бэк (Thomas Back) наблюдал интересные результаты при оценке коэффициентов мутации и перекрестного скрещивания хромосомы. Эта методика позволяет 14 генетическому алгоритму не только найти верное решение поставленной задачи, но и применить правильные коэффициенты использования генетических операторов

### Вероятности

Вероятности применения генетических операторов имеют большое значение. Например, если оператор мутации имеет слишком большую вероятность применения, это приводит к разрушению полезного генетического материала популяции и переключению на обычный поиск в произвольном порядке. Если коэффициенты слишком малы, поиск решения данной проблемы может занять намного больше времени, чем нужно

Если не используется самостоятельная адаптация (по Томасу Бэку), то правильные коэффициенты обычно находят путем эксперимента. Хорошая отправная точка – это установка коэффициента таким образом, чтобы к 70% выбранных родителей применялось перекрестное скрещивание, а в другом случае производилась мутация.

В зависимости от того, какой метод кодировки был выбран для задачи, некоторые генетические операторы могут стать деструктивными. Поэтому для правильного использования генетических операторов необходимо хорошее понимание кодировки и эффектов использования генетических операторов.

## Недостатки генетического алгоритма

Генетический алгоритм не лишен определенных недостатков. В этом разделе мы обсудим некоторые аспекты, которые следует учитывать при его применении.

#### Преждевременное схождение
Проблема преждевременного схождения связана с недостаточным разнообразием хромосом в популяции. Если большинство хромосом в популяции схожи между собой, то для селекции доступно меньше рабочего материала, и коэффициент увеличения здоровья снижается. Вы можете обнаружить эффект преждевременного схождения, сравнив среднее здоровье 15 популяции с максимальным здоровьем. Если они слишком схожи, это значит, что произошло преждевременное схождение популяции.

Самой распространенной причиной преждевременного схождения является слишком маленький размер популяции. При увеличении размера популяции проблема легко решается. Другой причиной может быть алгоритм отбора, который вы применяете. При использовании метода элиты выбираются только хромосомы с самым высоким здоровьем, что приводит к сильному уменьшению размера популяции по сравнению с начальным. Если популяция слишком рано сошлась, и решение не было найдено, вам следует перезапустить алгоритм. При перезапуске в популяцию будет введен новый материал, в котором может не быть небольшого количества доминирующих хромосом.

#### Эпистазис
Эпистазисом называется внутренняя зависимость между переменными (генами), закодированными в хромосоме. Если ни один ген не связан с другими генами в хромосоме, считается, что эпистазис очень мал или не существует. Если гены зависят друг от друга, эпистазис высок и может создать проблемы для алгоритмов рекомбинирования.

Обычное решение этой проблемы состоит в том, чтобы сохранять гены (переменные), которые близко связаны друг с другом в хромосоме. При группировании зависимых генов существенно снижается вероятность того, что они будут разрушены при применении генетических операторов, например, перекрестного скрещивания

### Теорема «не бывает бесплатных обедов»

Теорема «не бывает бесплатных обедов» основывается на идее о том, что не существует совершенного метода оптимизации. Нельзя решить задачу с помощью любой кодировки, метода селекции и набора вероятностей, из всех имеющихся возможностей необходимо выбрать оптимальный способ с учетом особенностей поставленной задачи.

### Другие области применения
Генетический алгоритм используется для решения многих задач оптимизации. Так как эффективность генетического алгоритма во многом зависит от представления решения, вы можете оптимизировать как числовые, так и символические задачи. Например, помимо простой функциональной оптимизации можно работать с такими символическими задачами, как задачи Ханойских Башен. 

Генетические алгоритмы применяются для решения следующих проблем:
- создание дизайна с помощью компьютера; 
- составление порядка решения задач; 
- экономические задачи и задачи теории игр; 
- другие задачи оптимизации.

В качестве составной части генетический алгоритм применялся в разработке, которая предназначена для вычисления абсолютного положения в пространстве при работе с телескопом. Таким образом было найдено соответствие между звездными четырехугольниками в каталоге и звездами в поле обзора телескопа, что позволило определить курс космического корабля.